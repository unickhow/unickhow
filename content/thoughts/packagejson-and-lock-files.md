---
title: åŸºæœ¬ package.json åŠé‚£äº› lock files
description: æ·ºè«‡å³æ­¢ ðŸ¤
date: 2024-10-26T21:00:00.000+08:00
schedule:
hidden: false
tags:
  - nodejs
  - npm
---


## åº

åœ¨å‰ç«¯é–‹ç™¼ä¸­ï¼Œ`package.json` å¯ä»¥èªªæ˜¯æ¯å€‹å°ˆæ¡ˆçš„å¿ƒè‡Ÿï¼Œå®ƒç‚ºæˆ‘å€‘ç®¡ç†å°ˆæ¡ˆçš„ä¾è³´ã€è…³æœ¬ä»¥åŠç’°å¢ƒè¨­å®šç­‰ç­‰ã€‚ç„¡è«–ä½ æ˜¯å‰›é–‹å§‹å­¸ç¿’å‰ç«¯ï¼Œé‚„æ˜¯å·²ç¶“æœ‰å¹¾å¹´ç¶“é©—ï¼Œç†è§£ `package.json` çš„é—œéµéƒ¨åˆ†éƒ½å°å°ˆæ¡ˆçš„é–‹ç™¼èˆ‡ç¶­è­·æœ‰èŽ«å¤§çš„å¹«åŠ©ã€‚é€™ç¯‡æ–‡ç« æœƒç¨å¾®åœ°å¸¶ä¸Šä¸€äº›åœ¨å‰ç«¯é–‹ç™¼ä¸Šï¼Œæ‡‰è©²çŸ¥é“çš„å¹¾å€‹é‡é»žå±¬æ€§ã€‚


## package.json

### dependencies
`dependencies` æ˜¯æŒ‡å°ˆæ¡ˆåœ¨ã€ŒåŸ·è¡Œæ™‚ (runtime)ã€éœ€è¦ä¾è³´çš„å¥—ä»¶ï¼Œä¹Ÿå°±æ˜¯ç•¶ä½ çš„æ‡‰ç”¨ç¨‹å¼åœ¨ä½¿ç”¨è€…ç€è¦½å™¨æˆ–ä¼ºæœå™¨ä¸Šé‹è¡Œæ™‚ï¼Œæ‰€å¿…é ˆçš„å¥—ä»¶ã€‚ä¾‹å¦‚ï¼Œè‹¥ä½ åœ¨é–‹ç™¼ä¸€å€‹ React æ‡‰ç”¨ï¼Œ`react` å’Œ `react-dom` é€™äº›å¥—ä»¶å°±æ‡‰è©²è¢«æ”¾åœ¨ `dependencies` è£¡ã€‚

```json
{
  "dependencies": {
    "vue": "^3.2.47",
    "vue-router": "^4.2.0",
    "pinia": "^2.0.34"
  }
}
```

### devDependencies
`devDependencies` å‰‡æ˜¯æŒ‡é–‹ç™¼éŽç¨‹ä¸­éœ€è¦çš„å¥—ä»¶ï¼Œé€™äº›å¥—ä»¶åœ¨å°ˆæ¡ˆã€Œé‹è¡Œã€æ™‚å…¶å¯¦ä¸¦ä¸éœ€è¦å­˜åœ¨ï¼Œåªæ˜¯ç”¨ä¾†è¼”åŠ©é–‹ç™¼ã€‚ä¾‹å¦‚ï¼šæ¸¬è©¦å·¥å…·ã€ç·¨è­¯å·¥å…·æˆ– lint å·¥å…·ï¼ˆåƒæ˜¯ `eslint` æˆ– `vite`ï¼‰å°±æœƒæ”¾åœ¨ `devDependencies` è£¡ã€‚

```json
{
  "devDependencies": {
    "eslint": "^8.35.0",
    "vite": "^5.2.0"
  }
}

```

åˆç†åœ°å€åˆ† `dependencies` å’Œ `devDependencies` èƒ½å¹«åŠ©æˆ‘å€‘æœ‰æ•ˆç®¡ç†å°ˆæ¡ˆçš„å¤§å°ï¼Œå°¤å…¶æ˜¯åœ¨éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒæ™‚ã€‚ä½ ä¸æœƒæƒ³è¦å¸¶è‘—å¤§é‡ä¸å¿…è¦çš„é–‹ç™¼å·¥å…·é€²å…¥ç”Ÿç”¢ç’°å¢ƒï¼Œé€™åªæœƒæ‹–æ…¢è¼‰å…¥é€Ÿåº¦ï¼Œä¹Ÿå¢žåŠ äº†æ½›åœ¨çš„é¢¨éšªã€‚

### engines
`engines` æ˜¯ä¸€å€‹ç¶“å¸¸è¢«å¿½ç•¥ä½†ååˆ†å¯¦ç”¨çš„æ¬„ä½ï¼Œå®ƒè®“ä½ å¯ä»¥æŒ‡å®šå°ˆæ¡ˆé‹è¡Œæ‰€éœ€çš„ Node.js æˆ– npm/yarn ç‰ˆæœ¬ã€‚é€™å°æ–¼åœ˜éšŠå”ä½œæˆ–é•·æœŸç¶­è­·å°ˆæ¡ˆæ™‚å°¤å…¶é‡è¦ï¼Œèƒ½é¿å…å› ç‚ºé–‹ç™¼ç’°å¢ƒä¸åŒè€Œç”¢ç”Ÿçš„å•é¡Œã€‚

ä¾‹å¦‚ï¼Œå¦‚æžœä½ çš„å°ˆæ¡ˆéœ€è¦ç‰¹å®šç‰ˆæœ¬çš„ Node.js æ‰èƒ½æ­£å¸¸é‹è¡Œï¼Œä½ å¯ä»¥åœ¨ `package.json` ä¸­é€™æ¨£æŒ‡å®šï¼š

```json
{
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=6.0.0"
  }
}
```

é€™æ¨£ï¼Œç•¶æœ‰äººåœ¨ä¸åŒç‰ˆæœ¬çš„ Node.js æˆ– npm ä¸­å˜—è©¦å®‰è£å¥—ä»¶æ™‚ï¼Œæœƒæ”¶åˆ°è­¦å‘Šï¼Œç”šè‡³å¯ä»¥è¨­å®šè®“å®‰è£éŽç¨‹è‡ªå‹•å¤±æ•—ï¼Œç¢ºä¿ç’°å¢ƒçš„ä¸€è‡´æ€§ã€‚

ä½†å¾ˆå¯æƒœï¼Œæˆ‘æœ€è¿‘å¸¸ç”¨çš„ bun ç›®å‰é‚„æ²’æœ‰è¢«æ”¯æ´åœ¨ engines æ¬„ä½ä¸­æŒ‡å®šã€‚ä¸éŽï¼Œéš¨è‘— Bun çš„å¿«é€Ÿç™¼å±•å’Œæ—¥ç›Šå¢žé•·çš„æŽ¡ç”¨çŽ‡ï¼Œæˆ‘å€‘å¯ä»¥æœŸå¾…åœ¨æœªä¾†çš„æŸå€‹æ™‚å€™ï¼Œå®ƒä¹Ÿæœƒè¢«åŠ å…¥åˆ°é€™å€‹åˆ—è¡¨ä¸­ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå¦‚æžœä½ çš„å°ˆæ¡ˆéœ€è¦ç‰¹å®šç‰ˆæœ¬çš„ Bunï¼Œä½ å¯èƒ½éœ€è¦åœ¨å°ˆæ¡ˆçš„æ–‡æª”æˆ– README ä¸­æ˜Žç¢ºèªªæ˜Žé€™ä¸€éœ€æ±‚ã€‚

### scripts
`scripts` æ¬„ä½è®“ä½ å¯ä»¥å®šç¾©ä¸€ç³»åˆ—æ–¹ä¾¿çš„å‘½ä»¤ï¼Œåƒæ˜¯å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ã€åŸ·è¡Œæ¸¬è©¦ã€ç·¨è­¯ç¨‹å¼ç­‰ã€‚ä¾‹å¦‚ï¼š

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
  }
}
```

å¦‚æžœä½ ä½¿ç”¨éŽ vite ä¾†å»ºç«‹å°ˆæ¡ˆï¼Œä¸Šé¢é€™äº›å‘½ä»¤ä¸€å®šä¸é™Œç”Ÿã€‚é€™äº›å‘½ä»¤åˆ†åˆ¥ç”¨æ–¼å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ã€æ§‹å»ºç”Ÿç”¢ç‰ˆæœ¬å’Œé è¦½æ§‹å»ºçµæžœã€‚ä½¿ç”¨é€™äº›é å®šç¾©çš„è…³æœ¬ä¸åƒ…å¯ä»¥ç°¡åŒ–é–‹ç™¼æµç¨‹ï¼Œé‚„èƒ½ç¢ºä¿åœ˜éšŠæˆå“¡ä½¿ç”¨ä¸€è‡´çš„å‘½ä»¤ä¾†åŸ·è¡Œå¸¸è¦‹ä»»å‹™ã€‚æ­¤å¤–ï¼Œä½ é‚„å¯ä»¥æ ¹æ“šå°ˆæ¡ˆéœ€æ±‚è‡ªå®šç¾©æ›´å¤šçš„è…³æœ¬ï¼Œä¾‹å¦‚é‹è¡Œæ¸¬è©¦ã€ä»£ç¢¼æ ¼å¼åŒ–æˆ–éƒ¨ç½²ç­‰æ“ä½œã€‚

æˆ‘å¸¸ç”¨çš„åƒæ˜¯å¯ä»¥å®šç¾©åœ¨éƒ¨ç½²ä¸åŒç’°å¢ƒæ™‚è©²å¸¶å…¥ä»€éº¼ç’°å¢ƒè®Šæ•¸

```json
{
  "scripts": {
    "build": "vite build",
    "build:dev": "vite build --mode staging" // æ‰“åŒ…æ™‚æœƒè¼‰å…¥ .env.stage
  }
}
```

æˆ–æ˜¯å°ˆæ¡ˆæœ‰ç›¸é—œçš„ subtree è¦åŒæ­¥çš„è©±ï¼Œä¾‹å¦‚ i18n å­—å…¸

```json
{
  "scripts": {
    "i18n:pull": "git subtree pull -P src/locales --squash git@github.com:unickhow/my_i18n_dictionary.git main",
    "i18n:push": "git subtree push -P src/locales git@github.com:unickhow/my_i18n_dictionary.git main"
  }
}
```

### type
ä¸Šè¿°æåˆ°çš„å±¬æ€§éƒ½æ˜¯å±¬æ–¼ npm æä¾›çš„æ¨™æº–å±¬æ€§ï¼Œä½† `type` é€™å€‹æ¬„ä½å…¶å¯¦æ˜¯å±¬æ–¼ Node.js çš„ã€‚`type: "module"` æ˜¯ `package.json` ä¸­çš„ä¸€å€‹é—œéµæ¬„ä½ï¼Œå®ƒå‘Šè¨´ Node.js é€™å€‹å°ˆæ¡ˆä½¿ç”¨çš„æ˜¯ **ES Module** è¦ç¯„ï¼Œè€Œä¸æ˜¯å‚³çµ±çš„ CommonJS æ¨¡å¡Šç³»çµ±ã€‚é€™æ˜¯ç¾ä»£ JavaScript é–‹ç™¼ä¸­éžå¸¸é‡è¦çš„ä¸€å€‹è¨­å®šï¼Œå› ç‚ºå®ƒæ±ºå®šäº†ä½ åœ¨å°ˆæ¡ˆä¸­å¦‚ä½•å¼•å…¥å’Œå°Žå‡ºæ¨¡å¡Šã€‚

- **ES Module**ï¼šä½¿ç”¨ `import` å’Œ `export` é—œéµå­—ä¾†é€²è¡Œæ¨¡å¡Šçš„å°Žå…¥å’Œå°Žå‡ºï¼Œæ˜¯ç¾ä»£ JavaScript åŽŸç”Ÿæ”¯æŒçš„æ¨¡å¡Šç³»çµ±ï¼Œä¹Ÿæ˜¯ç€è¦½å™¨æ¨™æº–ã€‚
- **CommonJS**ï¼šå‚³çµ±çš„æ¨¡å¡Šç³»çµ±ï¼Œä½¿ç”¨ `require()` å’Œ `module.exports` ä¾†å°Žå…¥å’Œå°Žå‡ºæ¨¡å¡Šï¼Œé€™æ˜¯ Node.js é•·æœŸä»¥ä¾†ä½¿ç”¨çš„æ–¹å¼ã€‚

ç•¶ä½ è¨­ç½® `type: "module"` æ™‚ï¼š

1. ä½¿ç”¨ `import/export`ï¼šä½ å¯ä»¥åœ¨ Node.js ä¸­ç›´æŽ¥ä½¿ç”¨ ES Module çš„èªžæ³•ï¼š
    ```jsx
    import fs from 'fs'
    export function myFunction() {
      console.log('Hello, ES Module!')
    }
    ```

2. `.js` æ–‡ä»¶é»˜èªç‚º ESMï¼šæ‰€æœ‰çš„ `.js` æ–‡ä»¶æœƒè¢«ç•¶ä½œ ES Module è™•ç†ã€‚å¦‚æžœä½ è¦ä½¿ç”¨ CommonJS æ–‡ä»¶ï¼Œå®ƒå€‘éœ€è¦å‘½åç‚º `.cjs`ã€‚

3. `.mjs` æ–‡ä»¶ï¼šå³ä½¿ä½ æ²’æœ‰è¨­ç½® `type: "module"`ï¼Œåªè¦æ–‡ä»¶çš„æ“´å±•åæ˜¯ `.mjs`ï¼ŒNode.js ä¹Ÿæœƒè‡ªå‹•å°‡å®ƒè¦–ç‚º ES Moduleã€‚


ä¾‹å¦‚ï¼Œç•¶ `package.json` ä¸­è¨­å®šäº† `type: "module"`ï¼Œä½ å¯ä»¥åœ¨ `.js` ä¸­é€™æ¨£ä½¿ç”¨
```jsx [utils.js]
export function add(a, b) {
  return a + b
}
```
```jsx [index.js]
import { add } from './utils.js'
console.log(add(2, 3))  // è¼¸å‡º 5
```

é€™èˆ‡ CommonJS çš„ `require` æ¨¡å¼å½¢æˆäº†é®®æ˜Žå°æ¯”ï¼š

```jsx [utils.js]
module.exports = {
  add(a, b) {
    return a + b
  }
}
```
```jsx [index.js]
const { add } = require('./utils')
console.log(add(2, 3))  // è¼¸å‡º 5
```

å¦‚æžœä½ å¸Œæœ›å°ˆæ¡ˆåŒæ™‚æ”¯æŒ ES Module å’Œ CommonJSï¼Œå¯ä»¥é€šéŽä½¿ç”¨ `.mjs`ã€`.cjs` å‰¯æª”åä¾†å€åˆ†ã€‚

ç¾ä»£ JavaScript æ­£åœ¨æœå‘æ¨™æº–åŒ– ES Module çš„æ–¹å‘ç™¼å±•ï¼Œç‰¹åˆ¥æ˜¯åƒ Viteã€Rollupã€Webpack ç­‰æ‰“åŒ…å·¥å…·ä»¥åŠç€è¦½å™¨éƒ½å¤©ç„¶æ”¯æŒ ES Moduleã€‚ä½¿ç”¨ `type: "module"` æ˜¯é©æ‡‰é€™ä¸€è¶¨å‹¢çš„æ­¥é©Ÿï¼Œè®“ä½ çš„å°ˆæ¡ˆæ›´ç¬¦åˆç¾ä»£æ¨™æº–ï¼ŒåŒæ™‚ä¹Ÿèƒ½äº«å— Tree Shaking ç­‰å„ªåŒ–åŠŸèƒ½ã€‚

ç•¶ç„¶ï¼Œpackage.json é‚„æœ‰å¾ˆå¤šå±¬æ€§ï¼Œgoogle ä¸€ä¸‹ä¹Ÿèƒ½æ‰¾åˆ°ä¸å°‘è§£èªªè©³ç›¡çš„æ–‡ç« ï¼Œé€™é‚Šåªç²—ç•¥åœ°è«‡åˆ°å¹¾å€‹é‡é»žã€‚ä¸éŽï¼Œé€™äº›å±¬æ€§å·²ç¶“è¶³ä»¥è®“æˆ‘å€‘ç†è§£ package.json åœ¨å°ˆæ¡ˆç®¡ç†ä¸­çš„æ ¸å¿ƒä½œç”¨ã€‚æ­£ç¢ºåœ°é…ç½®é€™äº›å±¬æ€§ä¸åƒ…å¯ä»¥æé«˜é–‹ç™¼æ•ˆçŽ‡ï¼Œé‚„èƒ½ç¢ºä¿å°ˆæ¡ˆçš„ç©©å®šæ€§å’Œå¯ç¶­è­·æ€§ã€‚æ›´å¤šè©³ç´°å…§å®¹è«‹ç§»é§• [npm å®˜æ–¹æ–‡ä»¶](https://docs.npmjs.com/cli/v10/configuring-npm/package-json) æˆ– [nodejs å®˜æ–¹æ–‡ä»¶](https://nodejs.org/docs/v20.18.0/api/packages.html)

æŽ¥ä¸‹ä¾†ï¼Œè®“æˆ‘å€‘ä¾†çœ‹çœ‹èˆ‡å¥—ä»¶ç®¡ç†ç›¸é—œçš„å¦ä¸€å€‹é‡è¦è©±é¡Œï¼šlock fileã€‚

## ä»€éº¼æ˜¯ lock file?

åœ¨ä½¿ç”¨ npmã€yarn æˆ– pnpm ç­‰ä¸åŒçš„å¥—ä»¶ç®¡ç†å·¥å…· (package managerï¼Œä¸‹ç¨± pm) æ™‚ï¼Œæ¯å€‹å·¥å…·æœƒç”Ÿæˆè‡ªå·±çš„ lock fileï¼Œç”¨ä¾†éŽ–å®šç¢ºåˆ‡çš„å¥—ä»¶ç‰ˆæœ¬ã€‚é€™äº›æ–‡ä»¶çš„åç¨±åˆ†åˆ¥æ˜¯ï¼š

- npm: `package-lock.json`
- yarn: `yarn.lock`
- pnpm: `pnpm-lock.yaml`
- bun: `bun.lockb`

lock file çš„ç›®çš„æ˜¯ç¢ºä¿åœ¨ä¸åŒçš„ç’°å¢ƒä¸­ï¼Œæ¯æ¬¡å®‰è£ç›¸åŒçš„å¥—ä»¶ç‰ˆæœ¬ï¼Œé¿å…å› ç‚ºç‰ˆæœ¬å·®ç•°è€Œå°Žè‡´å•é¡Œã€‚

### ç‰ˆæœ¬ï¼Ÿç‰ˆè™Ÿï¼Ÿ

é¦–å…ˆï¼Œå…ˆä¾†èªè­˜æ‰€è¬‚çš„ç‰ˆè™Ÿæ•¸å­—ä»£è¡¨ä»€éº¼æ„æ€ï¼š

![https://miro.medium.com/v2/resize:fit:1400/0*gh7hUWnQ85vq7Jzn.jpg](https://miro.medium.com/v2/resize:fit:1400/0*gh7hUWnQ85vq7Jzn.jpg)

é€šå¸¸é™¤äº†å›ºå®šç‰ˆè™Ÿå¤–ï¼Œé‚„æœƒæœ‰ `^` å’Œ `~` é€™å…©ç¨®ç¬¦è™Ÿï¼Œåˆ†åˆ¥ä»£è¡¨ä¸åŒçš„ç‰ˆæœ¬æ›´æ–°ç­–ç•¥ï¼š

- `^` å…è¨±æ›´æ–° minor å’Œ patchï¼Œä½†ä¸æ›´æ–° majorã€‚ä¾‹å¦‚ï¼š`^1.2.3` åœ¨åŸ·è¡Œå®‰è£æ™‚ï¼Œæœƒè‡ªå‹•å®‰è£åˆ°æœ€æ–°ç‰ˆæœ¬çš„ `1.x.x`ï¼Œä½†ä¸æœƒåˆ° `2.0.0`

- `~` å…è¨±æ›´æ–° patchï¼Œä½†ä¸æ›´æ–° minor å’Œ majorã€‚ä¾‹å¦‚ï¼š`~3.4.5` åœ¨åŸ·è¡Œå®‰è£æ™‚ï¼Œæœƒè‡ªå‹•å®‰è£åˆ°æœ€æ–°ç‰ˆæœ¬çš„ `3.4.x`ï¼Œä½†ä¸æœƒåˆ° `3.5.0`

ç•¶ä½ åœ¨ `package.json` ä¸­ä½¿ç”¨å¦‚ `^` æˆ– `~` é€™æ¨£çš„ç¯„åœç¬¦è™Ÿä¾†æŒ‡å®šä¾è³´ç‰ˆæœ¬æ™‚ï¼Œpm åœ¨ç¬¬ä¸€æ¬¡å®‰è£æ™‚æœƒæ ¹æ“šç¯„åœé¸æ“‡ç•¶å‰å¯ç”¨çš„æœ€æ–°ç‰ˆæœ¬ã€‚é€™æ¨£åšçš„ç›®çš„æ˜¯å…è¨±åœ¨ä¸€å®šç¯„åœå…§å®‰è£æ›´æ–°çš„ç‰ˆæœ¬ï¼ˆä¾‹å¦‚å°ç‰ˆæœ¬å‡ç´šæˆ–è£œä¸ç‰ˆæœ¬ï¼‰ã€‚å®ƒå…·é«”æ‰®æ¼”çš„è§’è‰²åŒ…æ‹¬ï¼š

1. **éŽ–å®šç¢ºåˆ‡çš„ç‰ˆæœ¬**ï¼šlock file æœƒè¨˜éŒ„æ¯å€‹ä¾è³´çš„ç¢ºåˆ‡ç‰ˆæœ¬ï¼Œç„¡è«– `package.json` ä¸­æŒ‡å®šçš„æ˜¯ç¯„åœç‰ˆæœ¬é‚„æ˜¯ç²¾ç¢ºç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œå‡è¨­ä½ åœ¨ `package.json` ä¸­ä½¿ç”¨ `^1.2.3`ï¼Œä½† lock file æœƒå…·é«”è¨˜éŒ„ã€Œå®‰è£æ™‚ã€é¸æ“‡çš„ç¢ºåˆ‡ç‰ˆæœ¬ï¼Œè­¬å¦‚ `1.2.5`ã€‚ä¸‹æ¬¡åŸ·è¡Œ `[pm] install` æ™‚ï¼Œç„¡è«–å…¶ä»–é–‹ç™¼è€…é‹è¡Œçš„ç’°å¢ƒå¦‚ä½•ï¼Œpm æœƒä¾æ“šå°æ‡‰ lock file ä¸­çš„ç‰ˆæœ¬é€²è¡Œå®‰è£ï¼Œè€Œä¸æ˜¯æ ¹æ“š `package.json` çš„ç¯„åœè¦å‰‡é‡æ–°é¸æ“‡æœ€æ–°ç‰ˆæœ¬ã€‚
2. **æé«˜å®‰è£ä¸€è‡´æ€§**ï¼šç”±æ–¼ lock file è¨˜éŒ„äº†ç²¾ç¢ºçš„ä¾è³´æ¨¹ï¼ˆåŒ…æ‹¬æ‰€æœ‰ç›´æŽ¥å’Œé–“æŽ¥ä¾è³´çš„å…·é«”ç‰ˆæœ¬ï¼‰ï¼Œå®ƒèƒ½ç¢ºä¿é–‹ç™¼åœ˜éšŠä¸­çš„æ¯ä¸€å€‹äººï¼Œä»¥åŠåœ¨ CI/CD ä¸­è‡ªå‹•æ§‹å»ºçš„æ‡‰ç”¨ç¨‹å¼ï¼Œæ‰€ä½¿ç”¨çš„ä¾è³´ç‰ˆæœ¬éƒ½å®Œå…¨ä¸€è‡´ï¼Œä¸æœƒå—åˆ°å¤–éƒ¨ç’°å¢ƒè®ŠåŒ–çš„å½±éŸ¿ã€‚
3. **æé«˜å®‰è£é€Ÿåº¦**ï¼šlock file å¯ä»¥åŠ é€Ÿå®‰è£éŽç¨‹ï¼Œå› ç‚ºå®ƒè·³éŽäº†ç‰ˆæœ¬è§£æžçš„éŽç¨‹ï¼ˆä¸éœ€è¦é‡æ–°è§£æž `^` æˆ– `~` ç­‰ç¯„åœè¦å‰‡ï¼‰ï¼Œç›´æŽ¥å®‰è£è¨˜éŒ„åœ¨ lock file ä¸­çš„ç‰ˆæœ¬ï¼Œé€™å°æ–¼æœ‰å¤§é‡ä¾è³´çš„å°ˆæ¡ˆä¾†èªªå°¤ç‚ºé‡è¦ã€‚

### ä¸€å€‹å°ˆæ¡ˆå¯ä»¥æœ‰å¹¾å€‹ lock fileï¼Ÿ

åœ¨å°ˆæ¡ˆä¸­åŒæ™‚å­˜åœ¨å¤šå€‹ lock fileï¼ˆä¾‹å¦‚åŒæ™‚æœ‰ `package-lock.json` å’Œ `yarn.lock`ï¼‰æœƒè®“ pm ç”¢ç”Ÿæ··æ·†ï¼Œå› ç‚ºå®ƒå€‘æœƒå˜—è©¦ä½¿ç”¨è‡ªå·±å°æ‡‰çš„ lock file ä¾†å®‰è£å¥—ä»¶ï¼Œé€™å¯èƒ½å°Žè‡´ä¾è³´ç‰ˆæœ¬ä¸ä¸€è‡´çš„æƒ…æ³ã€‚ä¾‹å¦‚æˆ‘åœ¨é–‹ç™¼æ™‚ä½¿ç”¨ pnpm å®‰è£çš„æ˜¯ vue@3.5 çš„ç‰ˆæœ¬ï¼Œå°ˆæ¡ˆä¸­ä¹Ÿå¼•å…¥äº† v3.5 æ–°å¢žçš„ apiï¼Œè€Œå…¶ä»–å”ä½œè€…å‰‡æ˜¯ä½¿ç”¨ yarnï¼Œå°Žè‡´ä»–å€‘åœ¨æœ¬åœ°é–‹ç™¼æ™‚è¼‰å…¥çš„æ˜¯ yarn.lock ä¸­çš„ vue@3.4 ç‰ˆæœ¬ã€‚é€™æœƒé€ æˆä»–å€‘çš„å°ˆæ¡ˆå‡ºç¾ç„¡æ³•é æœŸçš„éŒ¯èª¤æˆ–è¡Œç‚ºï¼Œæ›´åˆ¥èªªå¦‚æžœ CI/CD ä¸Šåˆæ˜¯ç”¨å¦ä¸€å¥— pm çš„è©±ï¼Œå¾Œæžœå¯èƒ½æœƒæ›´åŠ åš´é‡ã€‚é€™ç¨®æƒ…æ³ä¸‹ï¼Œä¸åŒç’°å¢ƒé–“çš„ä¸ä¸€è‡´å¯èƒ½æœƒå°Žè‡´éƒ¨ç½²å¤±æ•—ã€åŠŸèƒ½ç•°å¸¸ï¼Œç”šè‡³æ˜¯å®‰å…¨æ¼æ´žã€‚å› æ­¤ï¼Œçµ±ä¸€ä½¿ç”¨ä¸€ç¨®åŒ…ç®¡ç†å·¥å…·å’Œå°æ‡‰çš„ lock file æ˜¯è‡³é—œé‡è¦çš„ã€‚é€™ä¸åƒ…èƒ½ç¢ºä¿é–‹ç™¼ç’°å¢ƒçš„ä¸€è‡´æ€§ï¼Œé‚„èƒ½å¤§å¤§æ¸›å°‘å› ç‰ˆæœ¬å·®ç•°è€Œå¼•ç™¼çš„å•é¡Œï¼Œæé«˜æ•´å€‹é–‹ç™¼å’Œéƒ¨ç½²æµç¨‹çš„å¯é æ€§ã€‚

## çµèªž

ä¹‹å‰åœ¨å°ˆæ¡ˆé–‹ç™¼çš„éŽç¨‹ä¸­ï¼Œç™¼ç¾æœ‰åŒäº‹ç«Ÿç„¶ä¸çŸ¥é“ `package-lock.json` è·Ÿ `pnpm-lock.yaml` æ˜¯ä»€éº¼ ðŸ™‚â€â†•ï¸ å…©è€…åŒæ™‚å‡ºç¾åœ¨ä»–çš„å°ˆæ¡ˆä¸­ä¹Ÿæ¸¾ç„¶ä¸è¦ºï¼Œä»¥åŠç„¡æ³•ç†è§£ç‚ºä»€éº¼æœ‰äº›å¥—ä»¶è¦åŠ ä¸Š `--save-dev` ðŸ˜€ï¼Œé€™è®“æˆ‘æ„è­˜åˆ°ï¼Œå³ä½¿æ˜¯å…¥è¡Œé€™éº¼ä¹…çš„å·¥ç¨‹å¸«ï¼Œå°æ–¼åŸºæœ¬çš„å¥—ä»¶ç®¡ç†æ¦‚å¿µä¹Ÿå¯èƒ½å­˜åœ¨èªçŸ¥å·®è·ï¼Œæ‰€ä»¥æ±ºå®šè‡¨æ™‚æ’æ’­ä¸€å‰‡è±†çŸ¥è­˜ä¾†è¨˜éŒ„ä¸€ä¸‹ï¼Œå…±å‹‰ä¹‹ ðŸ™


> references
>
> https://nodejs.org/docs/v20.18.0/api/packages.html *(node v20.18.0)*
>
> https://docs.npmjs.com/cli/v10/configuring-npm/package-json *(npm v10.9.0)*